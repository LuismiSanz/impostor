<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Impostor - Edición Ampliada</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { overscroll-behavior-y: contain; -webkit-tap-highlight-color: transparent; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONOS SVG ---
        const Icon = ({ children, size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>
        );
        const Users = (p) => <Icon {...p}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></Icon>;
        const Eye = (p) => <Icon {...p}><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></Icon>;
        const EyeOff = (p) => <Icon {...p}><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7c.68 0 1.35-.06 1.99-.17"/><line x1="2" y1="2" x2="22" y2="22"/></Icon>;
        const Play = (p) => <Icon {...p}><polygon points="5 3 19 12 5 21 5 3"/></Icon>;
        const HelpCircle = (p) => <Icon {...p}><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></Icon>;
        const CheckCircle = (p) => <Icon {...p}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></Icon>;
        const Skull = (p) => <Icon {...p}><circle cx="9" cy="12" r="1"/><circle cx="15" cy="12" r="1"/><path d="M8 20v2h8v-2"/><path d="m12.5 17-.5-1-.5 1h1z"/><path d="M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20"/></Icon>;
        const Plus = (p) => <Icon {...p}><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></Icon>;
        const Minus = (p) => <Icon {...p}><line x1="5" y1="12" x2="19" y2="12"/></Icon>;
        const XIcon = (p) => <Icon {...p}><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></Icon>;
        const Mic = (p) => <Icon {...p}><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="22"/></Icon>;
        const Sparkles = (p) => <Icon {...p}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275Z"/></Icon>;

        // --- BASE DE DATOS OFUSCADA (TEXTO INVERTIDO) ---
        // Se usa texto invertido para evitar spoilers al leer el código.
        const REVERSED_DB = {
            Comida: [
                { w: 'azziP', h: 'asaM' }, { w: 'ihsuS', h: 'zorrA' }, { w: 'aseugrubmaH', h: 'enraC' }, 
                { w: 'socaT', h: 'allitroT' }, { w: 'etalocohC', h: 'ecluD' }, { w: 'odaleH', h: 'oírF' }, 
                { w: 'allaeP', h: 'zorrA' }, { w: 'laereC', h: 'onuyaseD' }, { w: 'iteugapsE', h: 'atsaP' }, 
                { w: 'adalasnE', h: 'edreV' }, { w: 'oseuQ', h: 'oetcáL' }, { w: 'naP', h: 'aniraH' }, 
                { w: 'anaznaM', h: 'aturF' }, { w: 'oveuH', h: 'onuyaseD' }, { w: 'apoS', h: 'etneilaC' },
                { w: 'tanoD', h: 'ecluD' }, { w: 'satellaG', h: 'nruoH' }, { w: 'adamapmE', h: 'asaM' },
                { w: 'yriuC', h: 'etnaciP' }, { w: 'niuqodarB', h: 'enraC' }, { w: 'nómaJ', h: 'oditubmE' },
                { w: 'nóidnaS', h: 'ojoR' }, { w: 'aéroC', h: 'atsaP' }
            ],
            Famosos: [
                { w: 'arikahS', h: 'etnatnaC' }, { w: 'isseM', h: 'lobtúF' }, { w: 'nietsniE', h: 'aicneiC' },
                { w: 'uhcakiP', h: 'olliramA' }, { w: 'namtaB', h: 'eoréH' }, { w: 'esuoM yekciM', h: 'yensiD' },
                { w: 'rettoP yrraH', h: 'aigaM' }, { w: 'écnoyeB', h: 'acisúM' }, { w: 'odlanoR onaitsirC', h: 'loG' },
                { w: 'ossaciP', h: 'rotniP' }, { w: 'noskcaJ leahciM', h: 'eliaB' }, { w: 'artapoelC', h: 'anieR' },
                { w: 'sboJ evetS', h: 'aigolonceT' }, { w: 'tfiwS rolyaT', h: 'poP' }, { w: 'oiraM repuS', h: 'ogeujoediV' },
                { w: 'pmurT dlanoD', h: 'acitíloP' }, { w: 'ksum nolE', h: 'soituA' }, { w: 'ttoG rednoW', h: 'eniC' },
                { w: 'amoM nosaJ', h: 'raM' }, { w: 'tiP darB', h: 'rotcA' }
            ],
            Animales: [
                { w: 'orreP', h: 'atocsaM' }, { w: 'otaG', h: 'onileF' }, { w: 'etnefalE', h: 'ednarG' }, 
                { w: 'nóeL', h: 'ejavlaS' }, { w: 'nórubiT', h: 'raM' }, { w: 'aliugÁ', h: 'aleuV' }, 
                { w: 'oniugniP', h: 'oírF' }, { w: 'etneipreS', h: 'ograL' }, { w: 'afariJ', h: 'otlA' }, 
                { w: 'osO', h: 'euqsoB' }, { w: 'nífleD', h: 'etnegiletnI' }, { w: 'ergiT', h: 'sayaR' }, 
                { w: 'ojenoC', h: 'sajerO' }, { w: 'ollabaC', h: 'odipáR' }, { w: 'oboL', h: 'adanaM' },
                { w: 'agnaC', h: 'otlaS' }, { w: 'alaoK', h: 'otpilacuE' }, { w: 'acro', h: 'anisseA' },
                { w: 'ogiroG', h: 'etreuF' }, { w: 'nóalamac', h: 'roloC' }
            ],
            Deportes: [
                { w: 'lobtúF', h: 'loG' }, { w: 'otsecnolaB', h: 'atsanaC' }, { w: 'sineT', h: 'ateuqaR' },
                { w: 'nóicataN', h: 'augA' }, { w: 'oexoB', h: 'gniR' }, { w: 'lobieloV', h: 'deR' },
                { w: 'floG', h: 'oyoH' }, { w: 'lobsiéB', h: 'etaB' }, { w: 'ybugR', h: 'éleM' },
                { w: 'íuqsE', h: 'eveiN' }, { w: 'fruS', h: 'salO' }, { w: 'omsilciC', h: 'atelciciB' },
                { w: 'étaraK', h: 'nórutniC' }, { w: '1 alumróF', h: 'ehcoC' }, { w: 'omsiteltA', h: 'rerroC' },
                { w: 'floginiM', h: 'oñeuqeP' }, { w: 'ledáP', h: 'lasiR' }, { w: 'dlabnaH', h: 'onaM' },
                { w: 'forC', h: 'sasseP' }, { w: 'etaksan', h: 'nítap' }
            ],
            Países: [
                { w: 'añapsE', h: 'aporuE' }, { w: 'nópaJ', h: 'aisA' }, { w: 'aicnarF', h: 'erroT' },
                { w: 'ailatI', h: 'amoR' }, { w: 'lisarB', h: 'abmaS' }, { w: 'otpigE', h: 'acirfÁ' },
                { w: 'sodinu sodatsE', h: 'acirémAetroN' }, { w: 'ocixéM', h: 'etnaciP' }, { w: 'anihC', h: 'allaruM' },
                { w: 'ailartsuA', h: 'orugnaC' }, { w: 'anitnegrA', h: 'ognaT' }, { w: 'odinU onieR', h: 'alsI' },
                { w: 'ainamelA', h: 'azevreC' }, { w: 'aidnI', h: 'lahaM jaT' }, { w: 'ádanaC', h: 'oírF' },
                { w: 'íbreP', h: 'ahcuP' }, { w: 'aibmoloc', h: 'éfaC' }, { w: 'aissuR', h: 'akdoV' },
                { w: 'aicerG', h: 'soiD' }, { w: 'uqeR', h: 'avleS' }
            ],
            Lugares: [
                { w: 'ayalP', h: 'anerA' }, { w: 'latipsoH', h: 'dulaS' }, { w: 'aleucsE', h: 'raidutsE' }, 
                { w: 'eniC', h: 'alucíleP' }, { w: 'acetolbiB', h: 'oicneliS' }, { w: 'oisanmiG', h: 'etropeD' }, 
                { w: 'otroporea', h: 'ejaiV' }, { w: 'euqraP', h: 'erbiL eriA' }, { w: 'letoH', h: 'rimroD' }, 
                { w: 'etnaruatseR', h: 'remoC' }, { w: 'aicamraF', h: 'otnemacideM' }, { w: 'odacremrepuS', h: 'sarpmoC' }, 
                { w: 'oesnM', h: 'airotsiH' }, { w: 'oidatsE', h: 'ocilbúP' }, { w: 'ocnaB', h: 'oreniD' },
                { w: 'ocirC', h: 'ayasP' }, { w: 'ocigóolooZ', h: 'elaminA' }, { w: 'arudrep', h: 'artxE' },
                { w: 'anicifO', h: 'ojabarT' }, { w: 'elcraC', h: 'sajieR' }
            ],
            Transporte: [
                { w: 'nóivA', h: 'raloV' }, { w: 'ehcoC', h: 'areterraC' }, { w: 'ocraB', h: 'raM' },
                { w: 'nerT', h: 'saíV' }, { w: 'atelciciB', h: 'seladeP' }, { w: 'oretpócileH', h: 'seciléH' },
                { w: 'onirambuS', h: 'odnuforP' }, { w: 'súbotuA', h: 'sorejasaP' }, { w: 'otoM', h: 'ocsaC' },
                { w: 'etehoC', h: 'oicapsE' }, { w: 'nóimaC', h: 'agraC' }, { w: 'ixaT', h: 'daduiC' },
                { w: 'orteM', h: 'oenárretbuS' }, { w: 'etenitaP', h: 'sadeuR' }, { w: 'obolG', h: 'eriA' },
                { w: 'etayaY', h: 'ojuL' }, { w: 'aivnarT', h: 'liar' }, { w: 'elbac-orteM', h: 'atla' }
            ],
            Objetos: [
                { w: 'alliS', h: 'esratneS' }, { w: 'onófeleT', h: 'ramalL' }, { w: 'zipáL', h: 'ribircsE' }, 
                { w: 'joleR', h: 'opmeiT' }, { w: 'ojepsE', h: 'ojelfeR' }, { w: 'evalL', h: 'rirbA' }, 
                { w: 'otapaZ', h: 'eiP' }, { w: 'arahcuC', h: 'remoC' }, { w: 'safaG', h: 'reV' }, 
                { w: 'alihcoM', h: 'radrauG' }, { w: 'arodatupmoC', h: 'aigolonceT' }, { w: 'amaC', h: 'rimroD' }, 
                { w: 'arratiuG', h: 'acisúM' }, { w: 'azaT', h: 'rebeB' }, { w: 'orbiL', h: 'reeL' },
                { w: 'allibmoB', h: 'zuL' }, { w: 'arajíT', h: 'ratroC' }, { w: 'ollitraM', h: 'evalc' },
                { w: 'anatrS', h: 'nif' }, { w: 'allatnaP', h: 'negami' }
            ],
            Instrumentos: [
                { w: 'arratiuG', h: 'sadreuC' }, { w: 'onaiP', h: 'salceT' }, { w: 'aíretaB', h: 'sateuqaB' },
                { w: 'níloiV', h: 'ocrA' }, { w: 'atepmorT', h: 'otneiV' }, { w: 'atualF', h: 'odugA' },
                { w: 'nófoxaS', h: 'zzaJ' }, { w: 'aprA', h: 'legnA' }, { w: 'sacaraM', h: 'omtiR' },
                { w: 'nóedrocA', h: 'elleuF' }, { w: 'elelekU', h: 'oñeuqeP' }, { w: 'onofóliX', h: 'aredaM' },
                { w: 'ojnaB', h: 'yrtnuoC' }, { w: 'ollcnoivol', h: 'evarG' }, { w: 'acinomrA', h: 'osraM' }
            ],
            Profesiones: [
                { w: 'ocidéM', h: 'dulaS' }, { w: 'aíciloP', h: 'yeL' }, { w: 'orebmoB', h: 'ogeuF' }, 
                { w: 'roseforP', h: 'rañesnE' }, { w: 'orenicoC', h: 'adimoC' }, { w: 'atuanortsA', h: 'oicapsE' }, 
                { w: 'rotniP', h: 'etrA' }, { w: 'ocináceM', h: 'rarapeR' }, { w: 'otoliP', h: 'raloV' }, 
                { w: 'atsitneD', h: 'setneiD' }, { w: 'odagobA', h: 'aicitsuJ' }, { w: 'atsilobtuF', h: 'etropeD' }, 
                { w: 'rotcA', h: 'alucíleP' }, { w: 'ocifítneiC', h: 'oidutsE' }, { w: 'iranireteV', h: 'alaminA' },
                { w: 'reuqueroP', h: 'ollebaC' }, { w: 'rotircsE', h: 'orbiL' }, { w: 'refehC', h: 'ehcoC' }
            ]
        };

        // Función para invertir string (para decodificar la DB)
        const reverseString = (str) => str.split('').reverse().join('');

        // Función para preparar la DB (invertir las palabras para que se lean bien)
        const getDecodedDB = () => {
            const decoded = {};
            // Recorrer categorías
            Object.keys(REVERSED_DB).forEach(cat => {
                // Recorrer palabras de cada categoría
                decoded[cat] = REVERSED_DB[cat].map(item => ({
                    w: reverseString(item.w), // Invertir palabra
                    h: reverseString(item.h)  // Invertir pista
                }));
            });
            // Generar lista combinada para Aleatorio
            const allItems = Object.values(decoded).flat();
            decoded.Aleatorio = allItems;
            return decoded;
        };

        function ImpostorGame() {
            const [DB, setDB] = useState(null);
            const [gameState, setGameState] = useState('setup');
            const [playerNames, setPlayerNames] = useState(['Jugador 1', 'Jugador 2', 'Jugador 3', 'Jugador 4']);
            const [category, setCategory] = useState('Aleatorio');
            const [impostorHint, setImpostorHint] = useState(false); 
            
            const [gameTime, setGameTime] = useState(0);
            const [currentWordObj, setCurrentWordObj] = useState({ w: '', h: '' });
            const [impostorIndex, setImpostorIndex] = useState(null);
            const [startingPlayerIndex, setStartingPlayerIndex] = useState(null);
            const [currentPlayerIndex, setCurrentPlayerIndex] = useState(0); 
            const [showRole, setShowRole] = useState(false);
            const [timerInterval, setTimerInterval] = useState(null);

            const namesListRef = useRef(null);

            // Cargar DB al inicio
            useEffect(() => {
                const data = getDecodedDB();
                setDB(data);
            }, []);

            const addPlayer = () => {
                if (playerNames.length < 15) {
                    setPlayerNames([...playerNames, `Jugador ${playerNames.length + 1}`]);
                    setTimeout(() => namesListRef.current?.scrollTo({ top: 9999, behavior: 'smooth' }), 100);
                }
            };
            const removePlayer = () => { if (playerNames.length > 3) setPlayerNames(playerNames.slice(0, -1)); };
            const updateName = (index, val) => { const newNames = [...playerNames]; newNames[index] = val; setPlayerNames(newNames); };

            const startGame = () => {
                if (!DB) return;
                const items = DB[category];
                setCurrentWordObj(items[Math.floor(Math.random() * items.length)]);
                setImpostorIndex(Math.floor(Math.random() * playerNames.length));
                setStartingPlayerIndex(Math.floor(Math.random() * playerNames.length));
                setCurrentPlayerIndex(0); setShowRole(false); setGameState('pass'); setGameTime(0);
            };

            const handleNextPlayer = () => {
                setShowRole(false);
                if (currentPlayerIndex < playerNames.length - 1) {
                    setCurrentPlayerIndex(prev => prev + 1); setGameState('pass');
                } else {
                    startRound();
                }
            };

            const startRound = () => {
                setGameState('playing');
                const interval = setInterval(() => setGameTime(t => t + 1), 1000);
                setTimerInterval(interval);
            };

            const revealImpostor = () => { if (timerInterval) clearInterval(timerInterval); setGameState('result'); };
            const resetGame = () => { setGameState('setup'); if (timerInterval) clearInterval(timerInterval); };
            const formatTime = (s) => `${Math.floor(s / 60)}:${(s % 60).toString().padStart(2, '0')}`;

            const WarmContainer = ({ children, className = "" }) => (
                <div className={`min-h-screen bg-gradient-to-br from-orange-50 via-amber-50 to-orange-100 text-slate-800 flex flex-col items-center justify-center p-4 font-sans select-none ${className}`}>
                    <div className="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-[0.03] pointer-events-none"></div>
                    {children}
                </div>
            );

            // Si la DB no ha cargado, mostrar loading
            if (!DB) return <WarmContainer><div className="animate-pulse font-bold text-orange-500">Cargando palabras...</div></WarmContainer>;

            // 1. SETUP
            if (gameState === 'setup') {
                return (
                    <WarmContainer>
                        <div className="max-w-md w-full space-y-6 relative animate-in fade-in duration-500">
                            <div className="text-center">
                                <div className="inline-block p-3 bg-orange-100 rounded-full mb-2 shadow-sm"><Sparkles className="text-orange-500" size={24}/></div>
                                <h1 className="text-5xl font-black tracking-tighter text-transparent bg-clip-text bg-gradient-to-r from-orange-600 to-amber-600 uppercase drop-shadow-sm">Impostor</h1>
                                <p className="text-slate-500 text-sm font-medium">Configura tu partida</p>
                            </div>

                            <div className="bg-white p-6 rounded-3xl shadow-xl shadow-orange-200/40 border border-orange-100 space-y-6 relative overflow-hidden">
                                <div className="space-y-3 relative z-10">
                                    <div className="flex justify-between items-center px-1">
                                        <label className="text-xs font-bold text-slate-500 uppercase tracking-wider">Jugadores ({playerNames.length})</label>
                                        <div className="flex gap-2">
                                            <button onClick={removePlayer} disabled={playerNames.length <= 3} className="p-2 rounded-xl bg-orange-50 text-slate-400 hover:bg-red-50 hover:text-red-400 disabled:opacity-30 transition-colors border border-orange-100"><Minus size={18} /></button>
                                            <button onClick={addPlayer} disabled={playerNames.length >= 15} className="p-2 rounded-xl bg-orange-50 text-slate-400 hover:bg-orange-100 hover:text-orange-500 disabled:opacity-30 transition-colors border border-orange-100"><Plus size={18} /></button>
                                        </div>
                                    </div>
                                    <div ref={namesListRef} className="max-h-48 overflow-y-auto space-y-2 pr-1 scrollbar-hide">
                                        {playerNames.map((name, i) => (
                                            <div key={i} className="flex items-center bg-orange-50/50 border border-orange-100 rounded-2xl px-4 py-1 focus-within:border-orange-300 focus-within:bg-white transition-all">
                                                <span className="text-xs font-bold text-orange-300 mr-3">{i + 1}.</span>
                                                <input type="text" value={name} onChange={(e) => updateName(i, e.target.value)}
                                                    className="w-full bg-transparent py-2 text-sm text-slate-700 font-medium outline-none placeholder-slate-300" placeholder={`Nombre Jugador ${i + 1}`}
                                                />
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <div className="space-y-4 pt-6 border-t border-orange-100 relative z-10">
                                    <div>
                                        <label className="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-3">Categoría</label>
                                        <div className="flex overflow-x-auto gap-2 pb-2 no-scrollbar -mx-2 px-2">
                                            {DB && Object.keys(DB).map((cat) => (
                                                <button key={cat} onClick={() => setCategory(cat)}
                                                    className={`flex-shrink-0 px-4 py-2.5 text-sm font-bold rounded-xl transition-all border shadow-sm ${category === cat ? 'bg-orange-500 border-orange-500 text-white shadow-orange-200' : 'bg-white border-slate-200 text-slate-600 hover:bg-orange-50 hover:border-orange-200'}`}>
                                                    {cat}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                    <button onClick={() => setImpostorHint(!impostorHint)} className={`w-full flex items-center justify-between p-4 rounded-2xl border transition-all shadow-sm ${impostorHint ? 'bg-amber-50 border-amber-200' : 'bg-white border-slate-200 hover:border-orange-200'}`}>
                                        <div className="flex items-center gap-4">
                                            <div className={`p-2.5 rounded-xl transition-colors ${impostorHint ? 'bg-amber-500 text-white' : 'bg-slate-100 text-slate-400'}`}><HelpCircle size={20} /></div>
                                            <div className="text-left">
                                                <p className={`text-sm font-bold transition-colors ${impostorHint ? 'text-amber-900' : 'text-slate-700'}`}>Pista para Impostor</p>
                                                <p className="text-xs text-slate-500 font-medium">Recibe una palabra segura</p>
                                            </div>
                                        </div>
                                        <div className={`w-12 h-7 rounded-full transition-colors relative ${impostorHint ? 'bg-orange-500' : 'bg-slate-200'}`}><div className={`absolute top-1 left-1 w-5 h-5 bg-white rounded-full shadow-sm transition-transform ${impostorHint ? 'translate-x-5' : 'translate-x-0'}`} /></div>
                                    </button>
                                </div>
                                <button onClick={startGame} className="w-full py-4 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-2xl font-black text-lg shadow-xl shadow-orange-200/50 hover:shadow-orange-300/50 hover:scale-[1.01] active:scale-[0.98] transition-all flex items-center justify-center gap-2 relative z-10"><Play size={22} fill="currentColor" /> ¡A JUGAR!</button>
                            </div>
                        </div>
                    </WarmContainer>
                );
            }

            // 2. PASS
            if (gameState === 'pass') {
                return (
                    <WarmContainer className="text-center">
                        <div className="max-w-md w-full animate-in fade-in zoom-in duration-300">
                            <div className="mb-8 bg-white p-8 rounded-[3rem] shadow-xl shadow-orange-200/50 border border-orange-100">
                                <h2 className="text-slate-400 text-sm font-bold uppercase tracking-widest mb-4">Pasa el dispositivo a</h2>
                                <div className="relative inline-block">
                                    <div className="absolute -inset-4 bg-orange-200/50 rounded-full blur-xl opacity-70"></div>
                                    <h1 className="text-4xl font-black text-slate-800 relative">{playerNames[currentPlayerIndex]}</h1>
                                </div>
                                <p className="text-slate-500 text-sm mt-6 flex items-center justify-center gap-2"><EyeOff size={16}/> Nadie más debe mirar</p>
                            </div>
                            <button onClick={() => setGameState('reveal')} className="w-full py-5 bg-orange-500 text-white rounded-2xl font-bold text-xl shadow-xl shadow-orange-200/50 active:scale-95 transition-all hover:bg-orange-600">Soy {playerNames[currentPlayerIndex]}</button>
                        </div>
                    </WarmContainer>
                );
            }

            // 3. REVEAL
            if (gameState === 'reveal') {
                const isImpostor = currentPlayerIndex === impostorIndex;
                return (
                    <WarmContainer className="text-center">
                        <div className="max-w-md w-full space-y-6">
                            <h2 className="text-slate-500 font-bold uppercase tracking-widest text-xs">Tu Rol Secreto</h2>
                            <button onClick={() => setShowRole(!showRole)} className="relative w-full aspect-[3/4] bg-white rounded-3xl shadow-2xl shadow-orange-100/50 border-2 border-orange-50 flex flex-col items-center justify-center p-8 transition-all active:scale-[0.99] overflow-hidden group">
                                <div className="absolute inset-0 opacity-[0.05] bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-orange-500/20 to-transparent bg-[size:20px_20px]"></div>
                                {!showRole ? (
                                    <div className="relative z-10 space-y-4">
                                        <div className="w-24 h-24 mx-auto bg-orange-50 rounded-full flex items-center justify-center ring-4 ring-orange-100 group-hover:scale-105 transition-transform"><Eye size={40} className="text-orange-300" /></div>
                                        <p className="text-xl text-slate-700 font-black">Toca para revelar</p>
                                    </div>
                                ) : (
                                    <div className="relative z-10 w-full animate-in zoom-in duration-200">
                                        {isImpostor ? (
                                            <div className="space-y-6">
                                                <div className="inline-flex p-5 rounded-full bg-red-50 mb-2 ring-4 ring-red-100/50 shadow-sm"><Skull size={48} className="text-red-400" /></div>
                                                <div>
                                                    <h2 className="text-3xl font-black text-slate-800 uppercase tracking-widest mb-1">IMPOSTOR</h2>
                                                    <p className="text-xs text-slate-500 font-medium mb-6 bg-red-50 inline-block px-3 py-1 rounded-full">Misión: Engañar a todos</p>
                                                    <div className="bg-slate-50 p-5 rounded-2xl border border-slate-100">
                                                        {impostorHint ? (
                                                            <>
                                                                <p className="text-[10px] text-amber-600 font-bold uppercase mb-1">Tu palabra segura</p>
                                                                <p className="text-2xl font-black text-slate-700">"{currentWordObj.h}"</p>
                                                                <p className="text-[10px] text-slate-400 mt-2 font-medium">Úsala para despistar</p>
                                                            </>
                                                        ) : (
                                                            <p className="text-sm text-slate-600 font-medium leading-relaxed">No conoces la palabra.<br/>Escucha atentamente y mézclate.</p>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        ) : (
                                            <div className="space-y-6">
                                                <div className="inline-flex p-5 rounded-full bg-teal-50 mb-2 ring-4 ring-teal-100/50 shadow-sm"><CheckCircle size={48} className="text-teal-500" /></div>
                                                <div>
                                                    <h2 className="text-2xl font-black text-slate-800 uppercase tracking-widest mb-1">CIUDADANO</h2>
                                                    <p className="text-xs text-slate-500 font-medium mb-6 bg-teal-50 inline-block px-3 py-1 rounded-full">Misión: Encontrar al intruso</p>
                                                    <div className="bg-slate-50 p-5 rounded-2xl border border-slate-100">
                                                        <p className="text-[10px] text-teal-600 font-bold uppercase mb-1">Palabra Secreta</p>
                                                        <h1 className="text-3xl font-black text-slate-800 tracking-wide uppercase">{currentWordObj.w}</h1>
                                                    </div>
                                                </div>
                                            </div>
                                        )}
                                        <div className="mt-8 pt-4 border-t border-slate-100"><p className="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Toca para ocultar</p></div>
                                    </div>
                                )}
                            </button>
                            <button onClick={handleNextPlayer} className="w-full py-4 bg-white text-slate-800 rounded-xl font-bold hover:bg-orange-50 active:scale-95 transition-all border-2 border-orange-100 shadow-sm text-lg">{showRole ? 'Ocultar y Pasar' : 'Confirmar'}</button>
                        </div>
                    </WarmContainer>
                );
            }

            // 4. PLAYING
            if (gameState === 'playing') {
                return (
                    <WarmContainer>
                        <div className="flex justify-between items-center mb-6 w-full max-w-md">
                            <div className="flex items-center gap-2 bg-white px-3 py-1.5 rounded-full shadow-sm border border-orange-100">
                                <div className="w-2.5 h-2.5 bg-orange-500 rounded-full animate-pulse shadow-sm shadow-orange-300"></div>
                                <span className="text-xs font-bold text-slate-600 uppercase">En curso</span>
                            </div>
                            <button onClick={resetGame} className="p-2 bg-white rounded-full text-slate-400 hover:text-slate-600 hover:bg-orange-50 transition-colors shadow-sm border border-orange-100"><XIcon size={20}/></button>
                        </div>
                        <div className="flex-1 flex flex-col items-center justify-center space-y-8 max-w-md mx-auto w-full">
                            <div className="text-center space-y-1 relative">
                                <div className="absolute -inset-4 bg-orange-200/30 blur-2xl rounded-full z-0"></div>
                                <div className="text-8xl font-black text-slate-800 tracking-tighter tabular-nums relative z-10 drop-shadow-sm">{formatTime(gameTime)}</div>
                                <p className="text-xs text-slate-500 uppercase font-bold tracking-widest relative z-10">Tiempo de debate</p>
                            </div>
                            <div className="w-full bg-gradient-to-r from-amber-100 to-orange-100 border border-amber-200 p-6 rounded-3xl text-center relative overflow-hidden shadow-md shadow-orange-100">
                                <div className="absolute top-0 left-0 w-2 h-full bg-orange-400"></div>
                                <div className="absolute -right-4 -bottom-4 text-orange-200/50"><Mic size={64} /></div>
                                <p className="text-xs font-bold text-orange-600 uppercase mb-2 flex items-center justify-center gap-1 relative z-10"><Mic size={14} /> Empieza Hablando</p>
                                <h2 className="text-3xl font-black text-slate-800 relative z-10">{playerNames[startingPlayerIndex]}</h2>
                                <p className="text-xs text-slate-500 mt-2 font-medium relative z-10">Seguid el orden de la lista abajo</p>
                            </div>
                            <div className="w-full bg-white p-5 rounded-3xl border border-orange-100 shadow-lg shadow-orange-100/50">
                                <div className="flex flex-wrap justify-center gap-2">
                                    {playerNames.map((name, i) => (
                                        <div key={i} className={`px-4 py-2 rounded-xl border text-sm font-bold transition-all shadow-sm ${i === startingPlayerIndex ? 'bg-orange-500 border-orange-500 text-white shadow-orange-200' : 'bg-orange-50 border-orange-100 text-slate-600'}`}>{i + 1}. {name}</div>
                                    ))}
                                </div>
                            </div>
                            <button onClick={revealImpostor} className="w-full py-5 bg-red-500 hover:bg-red-600 text-white rounded-2xl font-black text-lg shadow-xl shadow-red-200/50 active:scale-95 transition-all">Terminar y Votar</button>
                        </div>
                    </WarmContainer>
                );
            }

            // 5. RESULT
            if (gameState === 'result') {
                return (
                    <WarmContainer className="text-center">
                        <div className="max-w-md w-full space-y-6 animate-in zoom-in duration-300">
                            <div className="bg-white p-8 rounded-[2.5rem] border border-orange-100 shadow-2xl shadow-orange-200/50 relative overflow-hidden">
                                <div className="absolute top-0 left-0 w-full h-3 bg-gradient-to-r from-red-400 via-orange-400 to-amber-400"></div>
                                <p className="text-slate-400 uppercase tracking-widest text-[10px] font-bold mb-8">Identidad Revelada</p>
                                <div className="mb-6 relative inline-block">
                                    <div className="absolute inset-0 bg-red-100 blur-xl rounded-full scale-150 opacity-50"></div>
                                    <Skull size={64} className="text-red-500 relative z-10 drop-shadow-sm" />
                                </div>
                                <h1 className="text-4xl font-black text-slate-800 mb-3">{playerNames[impostorIndex]}</h1>
                                <div className="inline-block px-4 py-1.5 bg-red-50 text-red-500 text-xs font-black rounded-full border border-red-100 mb-8 shadow-sm">ERA EL IMPOSTOR</div>
                                <div className="pt-6 border-t border-slate-100 grid grid-cols-2 gap-4 bg-orange-50/50 -mx-8 -mb-8 p-8">
                                    <div className="text-left"><p className="text-[10px] text-teal-600 font-bold uppercase mb-1">Palabra Secreta</p><p className="text-xl font-black text-slate-700">{currentWordObj.w}</p></div>
                                    <div className="text-right opacity-60"><p className="text-[10px] text-amber-700 font-bold uppercase mb-1">Pista Segura</p><p className="text-xl font-bold text-slate-600">{currentWordObj.h}</p></div>
                                </div>
                            </div>
                            <div className="grid grid-cols-2 gap-3">
                                <button onClick={resetGame} className="py-4 bg-white text-slate-600 rounded-2xl font-bold text-sm hover:bg-orange-50 border-2 border-orange-50 transition-all shadow-sm">Configurar</button>
                                <button onClick={startGame} className="py-4 bg-orange-500 text-white rounded-2xl font-bold text-sm hover:bg-orange-600 transition-all shadow-lg shadow-orange-200/50">Jugar Otra Vez</button>
                            </div>
                        </div>
                    </WarmContainer>
                );
            }
            return null;
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ImpostorGame />);
    </script>
</body>
</html>
